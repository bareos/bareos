\chapter{Operating Systems}
\label{SupportedOSes}
\index[general]{Systems!Supported Operating Systems}
\index[general]{Support!Operating Systems}

The Bareos project provides and supports packages that have been released at
\url{http://download.bareos.org/bareos/release/}

However, the following tabular gives an overview, what components are expected on which platforms to run:

\begin{tabular}[h]{|l|c|c|c|c|}
  \hline
  \textbf{Operating Systems} & \textbf{Version} & \textbf{Client Daemon} & \textbf{Director Daemon} & \textbf{Storage Daemon} \\
  \hline
  \hline
  \multicolumn{5}{c}{\textbf{Linux}} \index[general]{Platform!Linux} \\
  \hline
  Arch Linux
  \index[general]{Platform!Arch Linux}
                  & ~ & \elink{X}{https://aur.archlinux.org/pkgbase/bareos/} & \elink{X}{https://aur.archlinux.org/pkgbase/bareos/} & \elink{X}{https://aur.archlinux.org/pkgbase/bareos/} \\
  \hline
  CentOS          & current & v12.4 & v12.4 & v12.4 \\
  \hline
  Debian          & current & v12.4 & v12.4 & v12.4 \\
  \hline
  Fedora          & current & v12.4 & v12.4 & v12.4 \\
  \hline
  Gentoo
  \index[general]{Platform!Gentoo}
                    & ~ & \elink{X}{https://packages.gentoo.org/package/app-backup/bareos} & \elink{X}{https://packages.gentoo.org/package/app-backup/bareos} & \elink{X}{https://packages.gentoo.org/package/app-backup/bareos} \\
  \hline
  openSUSE        & current & v12.4 & v12.4 & v12.4 \\
  \hline
  RHEL            & current & v12.4 & v12.4 & v12.4 \\
  \hline
  SLES            & current & v12.4 & v12.4 & v12.4 \\
  \hline
  Ubuntu          & current & v12.4 & v12.4 & v12.4 \\
  \hline
  \ilink{Univention Corporate Linux}{sec:UniventionCorporateServer} & App Center & v12.4 & v12.4 & v12.4 \\
  \hline
  \multicolumn{5}{c}{\textbf{MS Windows}} \\
  \hline
  \ilink{MS Windows}{sec:windows} 32bit & 10/8/7       & v12.4 & v15.2 & v15.2 \\
  ~                & 2008/Vista   &  &  &  \\
  ~                & 2003/XP      & v12.4--v14.2 &         &  \\
  \hline
  \ilink{MS Windows}{sec:windows} 64bit & 10/8/2012/7  & v12.4 & v15.2 & v15.2 \\
  ~                & 2008/Vista   &  &  &  \\
  \hline
  \multicolumn{5}{c}{\textbf{Mac OS}} \\
  \hline
  \ilink{Mac OS X/Darwin}{sec:macosx}   & ~ & v14.2 &  &  \\
  \hline
  \multicolumn{5}{c}{\textbf{BSD}} \\
  \hline
  FreeBSD
  \index[general]{Platform!FreeBSD}
                    & $\geq$ 5.0 & \elink{X}{http://www.freshports.org/sysutils/bareos-client/} & \elink{X}{http://www.freshports.org/sysutils/bareos-server/} & \elink{X}{http://www.freshports.org/sysutils/bareos-server/}  \\
  \hline
  OpenBSD          & ~ & X &  & ~ \\
  \hline
  NetBSD           & ~ & X &  & ~ \\
  \hline
  \multicolumn{5}{c}{\textbf{Unix}} \\
  %\hline
  %BSDI             & ~ & $\star$ & ~ & ~ \\
  \hline
  AIX
  \index[general]{Platform!AIX}
                   & $\geq$ 4.3 & com-13.2 & $\star$ & $\star$ \\
  \hline
  HP-UX
  \index[general]{Platform!HP-UX}
                   & ~ & com-13.2 & ~ & ~ \\
  \hline
  Irix             & ~ & $\star$ & ~ & ~ \\
  %\hline
  %OpenSolaris      & ~ & X & X & X \\
  \hline
  Solaris
  \index[general]{Platform!Solaris}
                   & $\geq$ 8 & com-12.4 & com-12.4 & com-12.4 \\
  \hline
  True64           & ~ & $\star$ & ~ & ~ \\
  \hline
\end{tabular}

\begin{center}
\begin{tabular}[h]{p{0,15\textwidth} p{0,8\textwidth}}
\textbf{vVV.V}   & starting with Bareos version VV.V, this platform is official supported by the Bareos.org project \\
\textbf{com-VV.V}   & starting with Bareos version VV.V, this platform is supported. However, pre-build packages are only available from  Bareos.com\\
\textbf{nightly} & provided by Bareos nightly build. Bug reports are welcome, however it is not official supported \\
\textbf{X}       & known to work \\
\textbf{$\star$} & has been reported to work by the community\\
\end{tabular}
\end{center}

% \paragraph{Notes}
% 
% \begin{itemize}
%     \item by GNU/Linux, we mean all x86 (32/64bit) versions of CentOS, Debian, Fedora, openSUSE, Red Hat Enterprise Linux, SLES and Ubuntu that are officially supported  by the distribution itself.
% \end{itemize}

\section{Linux}

\subsection{Packages for the different Linux platforms}
\label{sec:packages}

The following tables summarize what packages are available for the different Linux platforms.

This information is generated based on \url{http://download.bareos.com/bareos/release/}.
In most cases this is identical to the packages provided by \url{http://download.bareos.org/bareos/release/}.
Only if a package have been added later in a maintenance release, these information may differ.

Distributions that are no longer relevant are left out.
However, you might still find the packages on our download servers.

Bareos tries to provide all packages for all current platforms.
For extra packages, it depends if the distribution contains the required dependencies.

For general information about the packages, see \nameref{sec:BareosPackages}.

Packages names not containing the word \name{bareos} are required packages where we decided to include them ourselves.

{
    \small
    \input{autogenerated/bareos-packages-table-redhat.tex}
    \input{autogenerated/bareos-packages-table-fedora.tex}
    \input{autogenerated/bareos-packages-table-suse.tex}
    \input{autogenerated/bareos-packages-table-opensuse.tex}
    \input{autogenerated/bareos-packages-table-debian.tex}
    \input{autogenerated/bareos-packages-table-ubuntu.tex}
}


\input{operating-system-univention-corporate-server.tex}



\subsection{Debian.org / Ubuntu Universe}
\index[general]{Platform!Debian!Debian.org}
\index[general]{Platform!Debian!8}
\index[general]{Platform!Ubuntu!Universe}
\index[general]{Platform!Ubuntu!Universe!15.04}
\label{sec:DebianOrg}

The distributions of Debian $>=$ 8 include a version of Bareos.
Ubuntu Universe $>=$ 15.04 does also include these packages. 

In the further text, these version will be named \name{Bareos (Debian.org)} 
(also for the Ubuntu Universe version, as this is based on the Debian version).

\subsubsection{Limitations of the Debian.org/Ubuntu Universe version of Bareos}
\label{sec:DebianOrgLimitations}

    \begin{itemize}
        \item Debian.org does not include the libfastlz compression library and therefore the Bareos (Debian.org) packages do not offer the fileset options \parameter{compression=LZFAST}, \parameter{compression=LZ4} and \parameter{compression=LZ4HC}.
        \item Debian.org does not include the \package{bareos-webui} package.
    \end{itemize}



\section{Mac OS X}
\label{sec:macosx}
\index[general]{Platform!Mac!OS X}

Bareos for MacOS X is available either

\begin{itemize}
  \item via the \elink{Homebrew project}{https://brew.sh/} (\url{http://formulae.brew.sh/formula/bareos-client}) or
  \item as pkg file from \url{http://download.bareos.org/bareos/release/latest/MacOS/}.
\end{itemize}


However, you have to choose upfront, which client you want to use. Otherwise conflicts do occur.

Both packages contain the \bareosFd and \command{bconsole}.

% \subsubsection{Requirements}
%
% The \bareosFd is only the client component of the backup system.
% For proper operation the \bareosFd needs to have access to a \bareosDir and \bareosSd,
% typically installed on a (Linux) server machine in the local network.

\subsection{Installing the Bareos Client as PKG}
\index[general]{Installation!MacOS}

The Bareos installer package for Mac OS X contains the \bareosFd for Mac OS X 10.5 or later.

On your local Mac, you must be an admin user. The main user is an admin user.

Download the \file{bareos-client*.pkg} installer package from \url{http://download.bareos.org/bareos/release/latest/MacOS/}.

Find the .pkg you just downloaded.
Install the .pkg by holding the CTRL key, left-clicking the installer and choosing \bquote{open}.

Follow the directions given to you and finish the installation.

\subsection{Configuration}

To make use of your \bareosFd on your system, it is required to configure the \bareosDir and the local \bareosFd.

Configure the server-side by follow the instructions at \nameref{sec:AddAClient}.

After configuring the server-side you can either
transfer the necessary configuration file using following command
or configure the client locally.


\subsubsection{Option 1: Copy the director resource from the Bareos Director to the Client}

Assuming your client has the DNS entry
\host{client2.example.com} and has been added to \bareosDir as \resourcename{bareos-dir}{client}{client2-fd}:

\begin{commands}{}
scp /etc/bareos/bareos-dir-export/client/client2-fd/bareos-fd.d/director/bareos-dir.conf root@client2.example.com:/usr/local/etc/bareos/bareos-fd.d/director/
\end{commands}

This differs in so far, as on Linux the configuration files are located under
\path|/etc/bareos/|,
while on MacOS they are located at
\path|/usr/local/etc/bareos/|.



\subsubsection{Option 2: Edit the director resource on the Client}

Alternatively, you can edit the file \path|/usr/local/etc/bareos/bareos-fd.d/director/bareos-dir.conf|.

This can be done by right-clicking the finder icon in your task bar, select \bquote{Go to folder ...} and paste \path|/usr/local/etc/bareos/bareos-fd.d/director/|.

Select the \path|bareos-dir.conf| file and open it.

Alternatively you can also call following command on the command console:
\begin{commands}{}
open -t /usr/local/etc/bareos/bareos-fd.d/director/bareos-dir.conf
\end{commands}

The file should look similar to this:

\begin{bareosConfigResource}{bareos-fd}{director}{bareos-dir}
Director {
  Name = bareos-dir
  Password = "SOME_RANDOM_PASSWORD"
  Description = "Allow the configured Director to access this file daemon."
}
\end{bareosConfigResource}

Set this client-side password to the same value as given on the server-side.

\warning{The configuration file contains passwords and therefore must not be accessible for any users except admin users.}

\subsection{Restart bareos-fd after changing the configuration}

The bareos-fd must be restarted to reread its configuration:

\begin{commands}{Restart the \bareosFd}
sudo launchctl stop  org.bareos.bareos-fd
sudo launchctl start org.bareos.bareos-fd
\end{commands}

% Use \command{launchctl} to enable and disable the bareos file daemon.
% 
% \begin{commands}{Load (start) the \bareosFd}
% sudo launchctl load -w /Library/LaunchDaemons/org.bareos.bareos-fd.plist
% \end{commands}
% 
% \begin{commands}{Unload (stop) the \bareosFd}
% sudo launchctl unload -w /Library/LaunchDaemons/org.bareos.bareos-fd.plist
% \end{commands}

% Following command can be used to check its status:
% 
% \begin{commands}{Check the status of the \bareosFd}
% sudo launchctl list org.bareos.bareos-fd
% \end{commands}


\subsection{Verify that the Bareos File Daemon is working}

Open the \command{bconsole} on your \bareosDir and check the status of the client with

\begin{bconfig}{}
*<input>status client=client2-fd</input>
\end{bconfig}

In case, the client does not react, following command are useful the check the status:


\begin{commands}{Verify the status of \bareosFd}
# check if bareos-fd is started by system:
sudo launchctl list org.bareos.bareos-fd

# get process id (PID) of bareos-fd
pgrep bareos-fd

# show files opened by bareos-fd
sudo lsof -p `pgrep bareos-fd`

# check what process is listening on the \bareosFd port
sudo lsof -n -iTCP:9102 | grep LISTEN
\end{commands}

You can also manually start bareos-fd in debug mode by:

\begin{commands}{Start \bareosFd in debug mode}
sudo /usr/local/sbin/bareos-fd -f -d 100
\end{commands}
